// Generated by CoffeeScript 1.10.0
(function(window, $) {
  'use strict';
  var Playlist;
  Playlist = (function() {
    var defaults;

    defaults = {
      toggleSidebarOnSelect: true
    };

    function Playlist(container, options) {
      var base, current;
      this.container = container;
      this.options = $.extend({}, defaults, options);
      this.items = this.container.find(this.options['itemSelector']);
      this.items.on('click', 'a', (function(_this) {
        return function(e) {
          return _this._onClick(e);
        };
      })(this));
      if (typeof (base = this.options).ready === "function") {
        base.ready();
      }
      current = this.container.find(this.options['currentItemSelector']).first();
      if (current.length) {
        this.currentIndex = current.index();
      } else {
        this.currentIndex = 0;
      }
      this._setCurrent(this.currentIndex);
      return;
    }

    Playlist.prototype._setCurrent = function(index) {
      var base, current, previous;
      previous = this.items.eq(this.currentIndex);
      this.currentIndex = index;
      current = this.items.eq(index);
      current.siblings().removeClass(this.options['currentItemClass']);
      current.addClass(this.options['currentItemClass']);
      if (typeof (base = this.options).setCurrent === "function") {
        base.setCurrent(current, previous);
      }
    };

    Playlist.prototype.length = function() {
      return this.items.length;
    };

    Playlist.prototype.moveTo = function(index) {
      if (index < 0 || index >= this.length()) {
        return;
      }
      this._setCurrent(index);
    };

    Playlist.prototype.next = function() {
      var index;
      index = (this.currentIndex + 1) % this.length();
      return this.moveTo(index);
    };

    Playlist.prototype.previous = function() {
      var index;
      index = (this.length() + this.currentIndex - 1) % this.length();
      return this.moveTo(index);
    };

    Playlist.prototype._onClick = function(e) {
      var index, item;
      e.preventDefault();
      e.stopPropagation();
      item = $(e.target).closest(this.options['itemSelector']);
      index = this.items.index(item);
      this.moveTo(index);
      if (this.options.toggleSidebarOnSelect) {
        ($(window)).trigger('views-sidebar-toggle');
      }
    };

    return Playlist;

  })();
  return window.Playlist = Playlist;
})(this, this.jQuery);
